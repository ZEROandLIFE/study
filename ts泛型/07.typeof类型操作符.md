`typeof` 是 TypeScript 和 JavaScript 共有的操作符，但在 TypeScript 中，它有一个更强大的功能：**在类型上下文中推导值的类型**（即从运行时值生成编译时类型）。以下是它的详细用法和示例：

---

## **1. 基本用法：获取值的类型**
在 TypeScript 中，`typeof` 可以用于**类型注解**，直接获取一个值的类型。

### **示例**
```typescript
const person = { name: "Alice", age: 25 };

// 使用 typeof 获取 person 的类型
type Person = typeof person;
// 等价于：
// type Person = { name: string; age: number; }

const alice: Person = { name: "Alice", age: 25 }; // ✅ 正确
const bob: Person = { name: "Bob", age: "30" };   // ❌ 错误：age 必须是 number
```
- **作用**：`typeof person` 直接从 `person` 对象推导出其类型，避免手动定义 `type Person`。

---

## **2. 结合 `keyof` 获取对象的键**
`typeof` 和 `keyof` 结合使用，可以**从运行时对象推导出其键的联合类型**。

### **示例**
```typescript
const person = { name: "Alice", age: 25 };

type PersonKeys = keyof typeof person; // "name" | "age"

function getProperty(key: PersonKeys) {
  return person[key]; // ✅ 类型安全
}

getProperty("name"); // ✅ 正确，返回 string
getProperty("age");  // ✅ 正确，返回 number
// getProperty("gender"); // ❌ 错误：'gender' 不是 person 的键
```
- **作用**：`typeof person` 获取 `person` 的类型，`keyof` 提取其键，确保类型安全。

---

## **3. 获取函数类型**
`typeof` 可以用于**推导函数的类型**，包括参数和返回值类型。

### **示例**
```typescript
function greet(name: string): string {
  return `Hello, ${name}!`;
}

// 使用 typeof 获取 greet 的类型
type GreetFunction = typeof greet;
// 等价于：
// type GreetFunction = (name: string) => string;

const sayHello: GreetFunction = (name) => `Hi, ${name}!`; // ✅ 正确
const wrongFn: GreetFunction = (name: number) => `Hi, ${name}!`; // ❌ 错误：参数必须是 string
```
- **作用**：`typeof greet` 直接获取 `greet` 的函数类型，避免重复定义。

---

## **4. 获取类（Class）的类型**
`typeof` 可以用于**推导类的类型**（包括构造函数和实例类型）。

### **示例**
```typescript
class Person {
  constructor(public name: string, public age: number) {}
}

// 使用 typeof 获取 Person 类的构造函数类型
type PersonConstructor = typeof Person;
// 等价于：
// type PersonConstructor = new (name: string, age: number) => Person;

// 使用 typeof 获取 Person 实例的类型
type PersonInstance = Person; // 或 InstanceType<typeof Person>
// 等价于：
// type PersonInstance = { name: string; age: number; }

const person1: PersonInstance = { name: "Alice", age: 25 }; // ✅ 正确
const person2 = new Person("Bob", 30); // ✅ 正确
```
- **作用**：
  - `typeof Person` 获取类的**构造函数类型**（用于 `new` 操作）。
  - `Person`（或 `InstanceType<typeof Person>`）获取类的**实例类型**。

---

## **5. 获取枚举（Enum）的类型**
`typeof` 可以用于**推导枚举的类型**。

### **示例**
```typescript
enum Color {
  Red = "RED",
  Green = "GREEN",
  Blue = "BLUE",
}

// 使用 typeof 获取 Color 枚举的类型
type ColorType = typeof Color;
// 等价于：
// type ColorType = { Red: "RED", Green: "GREEN", Blue: "BLUE" };

// 获取枚举的值（联合类型）
type ColorValue = keyof typeof Color; // "Red" | "Green" | "Blue"
type ColorLiteral = Color[keyof typeof Color]; // "RED" | "GREEN" | "BLUE"

const color1: ColorValue = "Red"; // ✅ 正确
const color2: ColorLiteral = "GREEN"; // ✅ 正确
// const color3: ColorValue = "Yellow"; // ❌ 错误：'Yellow' 不是 Color 的键
```
- **作用**：
  - `typeof Color` 获取枚举的**对象类型**（包含键值对）。
  - `keyof typeof Color` 获取枚举的**键的联合类型**。
  - `Color[keyof typeof Color]` 获取枚举的**值的联合类型**。

---

## **6. 获取模块（Module）的类型**
`typeof` 可以用于**推导整个模块的导出类型**。

### **示例**
```typescript
// math.ts
export const add = (a: number, b: number) => a + b;
export const PI = 3.14;

// app.ts
import * as math from "./math";

// 使用 typeof 获取 math 模块的类型
type MathModule = typeof math;
// 等价于：
// type MathModule = {
//   add: (a: number, b: number) => number;
//   PI: number;
// };

const myAdd: MathModule["add"] = (a, b) => a + b; // ✅ 正确
const myPI: MathModule["PI"] = 3.14; // ✅ 正确
```
- **作用**：`typeof math` 获取整个模块的导出类型，方便类型复用。

---

## **7. 与 `ReturnType` 和 `Parameters` 结合**
`typeof` 可以和 `ReturnType`、`Parameters` 等工具类型结合，提取函数的返回类型或参数类型。

### **示例**
```typescript
function greet(name: string): string {
  return `Hello, ${name}!`;
}

// 获取 greet 的返回类型
type GreetReturn = ReturnType<typeof greet>; // string

// 获取 greet 的参数类型（元组）
type GreetParams = Parameters<typeof greet>; // [name: string]

const returnValue: GreetReturn = "Hello!"; // ✅ 正确
const params: GreetParams = ["Alice"]; // ✅ 正确
```
- **作用**：
  - `ReturnType<typeof fn>` 获取函数的返回类型。
  - `Parameters<typeof fn>` 获取函数的参数类型（元组）。

---

## **总结：`typeof` 的核心用途**
| 用途                    | 示例                          | 作用                         |
| ----------------------- | ----------------------------- | ---------------------------- |
| **获取对象的类型**      | `type Person = typeof person` | 从运行时对象推导编译时类型   |
| **结合 `keyof` 获取键** | `keyof typeof person`         | 获取对象的键的联合类型       |
| **获取函数类型**        | `type Fn = typeof greet`      | 推导函数的参数和返回类型     |
| **获取类的类型**        | `type Ctor = typeof Person`   | 推导类的构造函数或实例类型   |
| **获取枚举的类型**      | `keyof typeof Color`          | 推导枚举的键或值类型         |
| **获取模块的类型**      | `type Math = typeof math`     | 推导整个模块的导出类型       |
| **结合工具类型**        | `ReturnType<typeof fn>`       | 提取函数的返回类型或参数类型 |

### **为什么 `typeof` 重要？**
1. **减少重复代码**：避免手动定义类型，直接从值推导类型。  
2. **类型安全**：确保类型与实际值保持一致，避免错误。  
3. **动态适应**：当值发生变化时，类型会自动更新，无需手动修改。  

