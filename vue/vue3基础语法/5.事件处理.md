# Vue 事件处理

## 基本事件绑定

### 1. 内联事件处理
直接在模板中写简单逻辑（适合简单操作）：

```html
<button @click="count++">计数: {{ count }}</button>
```

**说明**：
- 点击按钮时，`count` 的值会自增
- 适用于非常简单的逻辑，复杂逻辑建议用方法

### 2. 调用方法
绑定到组件中定义的方法（推荐）：

```html
<button @click="sayHello">打招呼</button>
```

```typescript
const sayHello = () => {
  alert('Hello!')
}
```

**说明**：
- 点击按钮时，调用 `sayHello` 方法
- 方法可以包含复杂逻辑，易于维护

## 事件参数传递

### 1. 手动传递参数
如果需要传递自定义参数，可以显式传递 `$event` 或其他数据：

```html
<button @click="sayMessage('你好')">说你好</button>
```

```typescript
const sayMessage = (msg: string) => {
  alert(msg) // 输出 "你好"
}
```

### 2. 访问原生事件对象
如果需要访问 DOM 事件对象（如 `event.target`），需显式传递 `$event`：

```html
<input @input="handleInput($event)" @keyup.enter="submit">
```

```typescript
const handleInput = (event: Event) => {
  const target = event.target as HTMLInputElement
  console.log('输入值:', target.value)
}

const submit = () => {
  console.log('按了回车')
}
```

**说明**：
- `@input="handleInput($event)"`：传递原生事件对象
- `@keyup.enter="submit"`：监听回车键（`.enter` 是事件修饰符）

## 事件修饰符

Vue 提供了一系列事件修饰符，用于简化事件处理逻辑（如阻止默认行为、阻止冒泡等）。

### 1. 常用修饰符

| 修饰符     | 作用                                         | 示例                                |
| ---------- | -------------------------------------------- | ----------------------------------- |
| `.prevent` | 阻止默认行为（如 `event.preventDefault()`）  | `<form @submit.prevent="onSubmit">` |
| `.stop`    | 阻止事件冒泡（如 `event.stopPropagation()`） | `<a @click.stop="doThis">`          |
| `.self`    | 仅当事件从元素自身触发时调用（不包含子元素） | `<div @click.self="doThis">`        |
| `.once`    | 事件只触发一次                               | `<button @click.once="doThis">`     |
| `.capture` | 使用捕获模式（先触发父元素事件）             | `<div @click.capture="doThis">`     |
| `.passive` | 提升滚动性能（不阻止默认行为）               | `<div @scroll.passive="onScroll">`  |

### 2. 示例

```html
<!-- 阻止表单默认提交行为 -->
<form @submit.prevent="onSubmit">
  <button type="submit">提交</button>
</form>

<!-- 阻止点击事件冒泡 -->
<a @click.stop="doThis">阻止冒泡</a>

<!-- 回车键提交 -->
<input @keyup.enter="submit">
```

```typescript
const onSubmit = () => {
  console.log('表单提交，阻止了默认行为')
}

const doThis = () => {
  console.log('点击事件，阻止了冒泡')
}

const submit = () => {
  console.log('按了回车')
}
```

## 按键修饰符

Vue 允许监听特定按键事件（如 `@keyup.enter`、`@keydown.esc`）。

### 1. 内置按键别名

| 按键修饰符 | 说明      |
| ---------- | --------- |
| `.enter`   | 回车键    |
| `.esc`     | Escape 键 |
| `.space`   | 空格键    |
| `.up`      | 上箭头    |
| `.down`    | 下箭头    |
| `.left`    | 左箭头    |
| `.right`   | 右箭头    |

### 2. 自定义按键修饰符
可以通过 `config.keyCodes` 自定义按键别名（Vue 3 已移除，推荐直接用 keyCode）：

```html
<input @keyup.13="submit"> <!-- 13 是回车键的 keyCode -->
```

## 鼠标按钮修饰符

监听特定鼠标按钮事件：

| 修饰符    | 说明 |
| --------- | ---- |
| `.left`   | 左键 |
| `.right`  | 右键 |
| `.middle` | 中键 |

```html
<button @click.right="handleRightClick">右键点击</button>
```

## 注意事项

### 复杂逻辑用方法
避免在模板中写复杂逻辑，推荐绑定到方法：

```html
<!-- ❌ 不推荐 -->
<button @click="if (count > 0) count--">减少</button>

<!-- ✅ 推荐 -->
<button @click="decrement">减少</button>
```

```typescript
const decrement = () => {
  if (count.value > 0) count.value--
}
```

### 显式传递 `$event`
如果需要访问原生事件对象，显式传递 `$event`：

```html
<input @input="handleInput($event)">
```

### 合理使用修饰符
用修饰符替代手动调用 `event.preventDefault()` 或 `event.stopPropagation()`：

```html
<!-- ❌ 不推荐 -->
<form @submit="onSubmit($event)">
```

```typescript
const onSubmit = (event: Event) => {
  event.preventDefault()
  console.log('提交')
}
```

```html
<!-- ✅ 推荐 -->
<form @submit.prevent="onSubmit">
```

### 避免内联箭头函数
内联箭头函数会导致每次渲染都创建新函数，可能影响性能：

```html
<!-- ❌ 不推荐 -->
<button @click="() => doSomething(id)">点击</button>

<!-- ✅ 推荐 -->
<button @click="handleClick(id)">点击</button>
```

```typescript
const handleClick = (id: number) => {
  doSomething(id)
}
```

## 总结

| 场景         | 语法                           | 示例                                   |
| ------------ | ------------------------------ | -------------------------------------- |
| 内联事件     | `@click="count++"`             | `<button @click="count++">`            |
| 调用方法     | `@click="sayHello"`            | `<button @click="sayHello">`           |
| 传递参数     | `@click="sayMessage('你好')"`  | `<button @click="sayMessage('你好')">` |
| 访问事件对象 | `@input="handleInput($event)"` | `<input @input="handleInput($event)">` |
| 阻止默认行为 | `@submit.prevent`              | `<form @submit.prevent="onSubmit">`    |
| 阻止冒泡     | `@click.stop`                  | `<a @click.stop="doThis">`             |
| 回车键监听   | `@keyup.enter`                 | `<input @keyup.enter="submit">`        |

## 核心要点
- `@click`、`@input` 等用于监听事件
- 方法调用比内联逻辑更易维护
- `$event` 用于访问原生事件对象
- 修饰符（如 `.prevent`、`.stop`）可以简化代码
- 按键/鼠标修饰符用于监听特定按键或鼠标按钮
