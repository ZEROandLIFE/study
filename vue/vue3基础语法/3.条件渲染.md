# Vue 条件渲染详解

## 一、`v-if` / `v-else-if` / `v-else`

### 1. 基本用法
- `v-if` 用于条件性渲染一块内容，只有表达式为 `true` 时才会渲染该元素及其子元素
- 可以结合 `v-else-if` 和 `v-else` 实现多条件分支

**示例**：
```html
<template>
  <div>
    <div v-if="type === 'A'">显示 A</div>
    <div v-else-if="type === 'B'">显示 B</div>
    <div v-else>显示其他</div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const type = ref('A') // 修改为 'B' 或其他值测试
</script>
```
- 当 `type` 为 `'A'` 时，显示 "显示 A"
- 当 `type` 为 `'B'` 时，显示 "显示 B"
- 其他情况显示 "显示其他"

### 2. 特点
- **惰性渲染**：
  - 当条件为 `false` 时，元素不会渲染到 DOM（连 DOM 结构都不存在）
  - 当条件变为 `true` 时，才会重新渲染
- **适合场景**：
  - 初始条件不太可能变化的场景（如权限控制、初始化配置）
- **配合 `<template>`**：
  - 如果不想渲染额外的包裹元素，可以用 `<template>` 包裹多个元素：
  ```html
  <template v-if="isLoggedIn">
    <div>欢迎回来！</div>
    <button>退出</button>
  </template>
  ```

## 二、`v-show`

### 1. 基本用法
- `v-show` 始终渲染元素到 DOM，只是通过切换 CSS 的 `display: none` 来控制显示/隐藏

**示例**：
```html
<template>
  <div>
    <div v-show="isVisible">总是渲染，只是显示/隐藏</div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const isVisible = ref(true) // 改为 false 测试
</script>
```
- 当 `isVisible` 为 `true` 时，元素可见
- 当 `isVisible` 为 `false` 时，元素隐藏（但仍在 DOM 中）

### 2. 特点
- **始终渲染**：
  - 无论条件如何，元素都会被渲染到 DOM，只是通过 CSS 控制显示
- **适合场景**：
  - 频繁切换显示/隐藏的场景（如 Tab 切换、下拉菜单）
- **限制**：
  - 不能用于 `<template>`，必须用在单个元素上

## 三、`v-if` vs `v-show` 对比

| 特性                      | `v-if`                     | `v-show`                     |
| ------------------------- | -------------------------- | ---------------------------- |
| **渲染方式**              | 条件为 false 时不渲染 DOM  | 始终渲染 DOM，仅切换 display |
| **性能**                  | 初始渲染成本低（惰性）     | 切换成本低（频繁切换时更优） |
| **适用场景**              | 不频繁切换（如初始化配置） | 频繁切换（如 Tab、下拉菜单） |
| **能否用于 `<template>`** | 是                         | 否                           |
| **初始条件为 false**      | DOM 不存在                 | DOM 存在但隐藏               |

## 四、如何选择？

**用 `v-if` 当**：
- 条件很少变化（如用户权限、初始化配置）
- 需要完全销毁/重建组件（如重置组件状态）

**用 `v-show` 当**：
- 需要频繁切换显示/隐藏（如动态表单、可折叠面板）
- 希望保留 DOM 状态（如表单输入内容）

## 五、进阶用法

### 1. 结合 `key` 控制复用
- Vue 会尽可能复用元素（如输入框），但有时需要强制替换（如切换登录方式时清空输入框）：
```html
<template v-if="loginType === 'username'">
  <input key="username" placeholder="用户名">
</template>
<template v-else>
  <input key="email" placeholder="邮箱">
</template>
```
- 添加 `key` 后，切换条件时会完全替换元素，而非复用

### 2. 动态切换 `v-if` 和 `v-show`
- 如果需要运行时动态切换渲染方式，可以这样：
```html
<div :is="useVShow ? 'div' : 'template'" v-show="!useVShow && isVisible">
  <!-- 内容 -->
</div>
```
- （但通常直接选择 `v-if` 或 `v-show` 更清晰）

## 六、总结
- `v-if`：真正的条件渲染，适合不频繁切换的场景
- `v-show`：简单的 CSS 切换，适合频繁切换的场景
- **选择依据**：根据切换频率和是否需要保留 DOM 状态决定
