
**列表渲染**
<template>
  <div>
    <!-- 遍历数组 -->
    <ul>
      <li v-for="(item, index) in items" :key="item.id">
        {{ index + 1 }}. {{ item.name }}
      </li>
    </ul>
    
    <!-- 遍历对象 -->
    <ul>
      <li v-for="(value, key) in userInfo" :key="key">
        {{ key }}: {{ value }}
      </li>
    </ul>
    
    <!-- 重要：总是使用 key -->
    <div v-for="item in items" :key="item.id">
      {{ item.name }}
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const items = ref([
  { id: 1, name: '苹果' },
  { id: 2, name: '香蕉' },
  { id: 3, name: '橙子' }
])

const userInfo = ref({
  name: '张三',
  age: 25,
  email: 'zhang@example.com'
})
</script>
一、v-for 遍历数组
1. 基本用法
使用 v-for="(item, index) in array" 遍历数组，item 是当前项，index 是索引（可选）。

示例：

<template>
  <ul>
    <li v-for="(item, index) in items" :key="item.id">
      {{ index + 1 }}. {{ item.name }}
    </li>
  </ul>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const items = ref([
  { id: 1, name: '苹果' },
  { id: 2, name: '香蕉' },
  { id: 3, name: '橙子' }
])
</script>
输出：

1. 苹果
2. 香蕉
3. 橙子
2. 特点
item：当前遍历的数组元素。
index（可选）：当前元素的索引（从 0 开始）。
:key：必须提供唯一的 key（通常用 item.id），用于 Vue 的虚拟 DOM 优化。
二、v-for 遍历对象
1. 基本用法
使用 v-for="(value, key, index) in object" 遍历对象，value 是属性值，key 是属性名，index 是索引（可选）。

示例：

<template>
  <ul>
    <li v-for="(value, key) in userInfo" :key="key">
      {{ key }}: {{ value }}
    </li>
  </ul>
</template>

<script setup lang="ts">
import { ref } from 'vue'

const userInfo = ref({
  name: '张三',
  age: 25,
  email: 'zhang@example.com'
})
</script>
输出：

name: 张三
age: 25
email: zhang@example.com
2. 特点
value：当前属性的值。
key：当前属性的键（如 "name"、"age"）。
index（可选）：当前属性的索引（从 0 开始）。
:key：通常用 key（如 :key="key"），因为对象的键是唯一的。
三、v-for 的最佳实践
1. 始终使用 :key
为什么需要 key？
Vue 通过 key 识别虚拟 DOM 的变化，从而高效更新 DOM。如果没有 key，Vue 会使用“就地复用”策略，可能导致状态混乱（如表单输入错乱）。
如何选择 key？
优先使用唯一 ID（如 item.id）。
如果没有 ID，可以用 index（但不推荐，因为数组顺序变化会导致渲染问题）。
❌ 错误示例（无 key）：

<div v-for="item in items">
  {{ item.name }}
</div>
✅ 正确示例：

<div v-for="item in items" :key="item.id">
  {{ item.name }}
</div>
2. 避免 v-for 和 v-if 混用
问题：Vue 会优先处理 v-for，再处理 v-if，可能导致性能浪费。
解决方案：先用 computed 过滤数据，再遍历。
❌ 错误示例：

<div v-for="item in items" v-if="item.isActive">
  {{ item.name }}
</div>
✅ 正确示例：

<template>
  <div v-for="item in activeItems" :key="item.id">
    {{ item.name }}
  </div>
</template>

<script setup lang="ts">
import { computed, ref } from 'vue'

const items = ref([
  { id: 1, name: '苹果', isActive: true },
  { id: 2, name: '香蕉', isActive: false }
])

const activeItems = computed(() => items.value.filter(item => item.isActive))
</script>
3. 遍历数字范围
v-for 也可以遍历数字范围（从 1 开始）：


<span v-for="n in 5" :key="n">{{ n }} </span>
输出：
1 2 3 4 5

四、高级用法
1. 动态更新数组
Vue 能检测以下数组变化：

push()、pop()、shift()、unshift()
splice()
sort()
reverse()
示例：

<template>
  <button @click="items.push({ id: 4, name: '葡萄' })">添加</button>
  <ul>
    <li v-for="item in items" :key="item.id">
      {{ item.name }}
    </li>
  </ul>
</template>
2. 替换整个数组
直接赋值新数组（如 filter()、map()）也能触发更新：


<template>
  <button @click="items = items.filter(item => item.id !== 1)">
    删除 ID=1 的项
  </button>
  <ul>
    <li v-for="item in items" :key="item.id">
      {{ item.name }}
    </li>
  </ul>
</template>
3. 在 <template> 上使用 v-for
如果不想渲染额外包裹元素，可以用 <template>：


<template v-for="item in items" :key="item.id">
  <h3>{{ item.name }}</h3>
  <p>{{ item.description }}</p>
</template>
五、总结
场景	语法	示例
遍历数组	v-for="(item, index) in array"	v-for="item in items"
遍历对象	v-for="(value, key) in object"	v-for="(val, key) in userInfo"
遍历数字范围	v-for="n in 10"	v-for="n in 5"
使用 key	:key="item.id"	:key="item.id"
避免 v-if 混用	用 computed 过滤数据	computed(() => items.filter(...))
最佳实践
始终加 :key（优先用 id）。
避免 v-for + v-if，改用 computed 过滤。
操作数组用变异方法（如 push、splice）或直接赋值新数组。
复杂逻辑用 <template> 减少多余 DOM。